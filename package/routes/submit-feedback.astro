---
import { Image } from 'astro:assets';
import Logo from './assets/astrofeedback-logo.webp';
import PublicSubmissionForm from './components/PublicSubmissionForm.astro';
import VerticalContainer from './components/VerticalContainer.astro';
import Heading from './components/headings/Heading.astro';
import BaseLayout from './layouts/BaseLayout.astro';
---

<BaseLayout sideBarActiveItemID="submit-feedback-public">

  <VerticalContainer>

    <div class="flex flex-col w-full gap-2">

        <div class="flex flex-row text-center">
            <Heading tag={'h1'}><span id="ui-submit-feedback-title">Submit New Feedback</span></Heading>
            <Image src={Logo} alt="Logo" width={64} height={64} loading={'eager'}/>
        </div>

        <p class="text-center" id="ui-submit-feedback-description">
            We appreciate your feedback. Please fill out the form below.
        </p>

        <div class="divider my-0" />

        <div class="card bg-base-100 w-full shadow-xl">

            <PublicSubmissionForm server:defer>
                <slot name="fallback">
                    <div class="p-4">
                        <p class="text-center" id="ui-submit-feedback-form-preload">Loading form...</p>
                    </div>
                </slot>
            </PublicSubmissionForm>

        </div>

    </div>

  </VerticalContainer>

</BaseLayout>

<script>
import { $i18n, updateUiString } from "./store/i18n.ts";
import enJson from './store/translations/en.json';
    
    const i18n = $i18n('public/submit-feedback', enJson['public/submit-feedback']);
    
    i18n.subscribe(t => {
        updateUiString({
            element: 'ui-submit-feedback-title', 
            translation: t['title']
        })
        updateUiString({
            element: 'ui-submit-feedback-description', 
            translation: t['description']
        })
        updateUiString({
            element: 'ui-submit-feedback-form-preload', 
            translation: t['form-preload']
        })
    });
</script>