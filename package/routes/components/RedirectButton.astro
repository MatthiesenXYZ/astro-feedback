---
interface Props {
	link: string;
}

const { link } = Astro.props;
---

<redirect-button link={link}>
    <slot></slot>
</redirect-button>

<script>
    // Check if the custom element is already defined (exists) before defining it
    if (!customElements.get('redirect-button')) {
        // Create the custom element class
        class RedirectButton extends HTMLElement {
            constructor() {
                super();
                // Create a shadow root
                const shadow = this.attachShadow({ mode: 'open' });

                // Create elements
                const button = document.createElement('button');
                const slot = document.createElement('slot');
                const style = document.createElement('style');

                // Add styles
                style.textContent = `
                    button {
                        background-color: transparent;
                        border: none;
                        width: full;
                    }
                `;
    
                // Append slotted children to the button
                button.appendChild(slot);

                // Append styles and button to the shadow root
                shadow.appendChild(style);
                shadow.appendChild(button);
    
                // Get link attribute value
                const link = this.getAttribute('link');

                // Add event listener to button
                button.addEventListener('click', () => window.location.href = link!);
            }
        }
        
        // "Define" (add) the custom element to the window
        customElements.define('redirect-button', RedirectButton);
    }
</script>